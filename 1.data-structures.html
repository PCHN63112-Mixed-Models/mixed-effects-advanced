
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Data Structures &#8212; More Advanced Uses of Mixed-effects Models</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- So that users can add custom icons -->
  <script src="_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '1.data-structures';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Building Mixed-effects Models" href="2.building-mixed.html" />
    <link rel="prev" title="Introduction" href="0.intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="0.intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/logo.png" class="logo__image only-light" alt="More Advanced Uses of Mixed-effects Models - Home"/>
    <img src="_static/logo.png" class="logo__image only-dark pst-js-only" alt="More Advanced Uses of Mixed-effects Models - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="0.intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Data Structures</a></li>
<li class="toctree-l1"><a class="reference internal" href="2.building-mixed.html">Building Mixed-effects Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="3.clustered-data.html">Clustered Data</a></li>

<li class="toctree-l1"><a class="reference internal" href="4.repeated-measures-data.html">Repeated Measures Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="5.longitudinal-clustered-data.html">Longitudinal and Clustered Longitudinal</a></li>
<li class="toctree-l1"><a class="reference internal" href="summary.html">Summary</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/mixed-effects-advanced" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/PCHN63112-Mixed-Models/mixed-effects-advanced/issues/new?title=Issue%20on%20page%20%2F1.data-structures.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/1.data-structures.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Data Structures</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-structure">Types of Structure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustered-data">Clustered Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#repeated-measurements">Repeated Measurements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#longitudinal">Longitudinal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustered-longitudinal">Clustered Longitudinal</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structures-as-hierarchies">Structures as Hierarchies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-determine-the-structure-of-a-dataset">How to Determine the Structure of a Dataset?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-determine-the-unit-of-analysis">Step 1. Determine the <em>unit</em> of analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-determine-what-each-row-of-the-dataset-represents">Step 2. Determine what each <em>row</em> of the dataset represents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-determine-whether-you-have-clusters">Step 3. Determine whether you have clusters</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="data-structures">
<h1>Data Structures<a class="headerlink" href="#data-structures" title="Link to this heading">#</a></h1>
<p>… Note that many of these examples are taken from <a class="reference external" href="https://www.taylorfrancis.com/books/mono/10.1201/9781003181064/linear-mixed-models-brady-west-kathleen-welch-andrzej-galecki?context=ubx&amp;amp;refId=4dbda113-7f59-4ba9-a710-897ef536cfee">West, Welch &amp; Galecki (2022)</a>, which is the recommended text for this part of the unit.</p>
<section id="types-of-structure">
<h2>Types of Structure<a class="headerlink" href="#types-of-structure" title="Link to this heading">#</a></h2>
<section id="clustered-data">
<h3>Clustered Data<a class="headerlink" href="#clustered-data" title="Link to this heading">#</a></h3>
<p>The first type of data structure is referred to as <em>clustered data</em>. Unlike all the examples we have seen so far, clustered data has no repeated measurements on the units of analysis. Instead, the units are grouped, or nested, within <em>clusters</em> of units.</p>
<p>For example, the first clustered dataset we will see concerns the birth weight of rat pups. The rat pups represent the units of analysis and each only has a single weight, so there are no repeated measurements here. However, the pups can be grouped into <em>litters</em> from the same mother. The assumption here is that pups from the same litter may be correlated in some fashion. Perhaps one mother consistently has pups that are <em>underweight</em>, or <em>overweight</em>? We can also think of this as <em>two levels</em> of variation, one between the weights within a litter and one between litters. A LME model can be used to capture this structure.</p>
<p>Similarly, our second clustered dataset concerns maths scores from students. Each student is the unit of analysis and only has a single maths score, so there are no repeated measurements. Nevertheless, there is structure here, as each student is clustered within a class, and classes are clustered within a school. Much like the rat pups, the assumptions here is that students from the same class may be correlated, but also that classes from the same school may also be correlated. Perhaps some schools generally produce higher maths grades than other schools, and within those schools some classes also perform consistently better or worse. There are therefore <em>three levels</em> of variation here: scores, classes and schools. Again, even without repeated measurement of the unit of analysis, a LME model can capture this structure</p>
</section>
<section id="repeated-measurements">
<h3>Repeated Measurements<a class="headerlink" href="#repeated-measurements" title="Link to this heading">#</a></h3>
<p>The second type of data structure is <em>repeated measurements</em>. Obviously, we know a fair amount about these types of data by this point. However, as has been mentioned multiple times so far, there is a key difference between repeated measurements <em>with</em> replications and repeated measurements <em>without</em> replications. The power of LME models is only really available when we have replications. In other words, when there are <em>multiple</em> observations per-subject and per-repeat. Without this, we are confined to <em>random-intercepts</em> and must assume a compound symmetric covariance structure. This is effectively a repeated measures ANOVA without any sphericity correction.</p>
<p>For example, the repeated measurements dataset we will examine in this lesson concerns measurements of a chemical in the brains of rats under two different treatments. The treatments are defined <em>within-subject</em>, so each rat (the unit of analysis) gets <em>both</em>. Importantly, these measurements are collected from <em>three</em> different brain regions. Each rat therefore has 6 measurements, 3 for each treatment. If our interest is only on the effects of treatment, we can think of these as 3 replications per-repeat. Rather than averaging-over these replications to create a mean per-rat and per-treatment, we can instead use the replications directly in the model. This then allows much greater scope to capture complex random-effects structures, as we will see later in this lesson.</p>
</section>
<section id="longitudinal">
<h3>Longitudinal<a class="headerlink" href="#longitudinal" title="Link to this heading">#</a></h3>
<p>The third type of data structure is <em>longitudinal</em>. This is very similar to repeated measurements in the sense that each unit of analysis is measured <em>multiple times</em>. The difference is that these measurements are both <em>spaced</em> over a longer period of time and have a <em>natural order</em>. Repeated measurements are typically collected close together in time and the order of collection is largely immaterial. For instance, in the rat brain example above, the measurements were taken from each brain at the same point in time and it does not matter what order the brain regions were sampled in. Typically, this means that missing data is <em>less</em> common under repeated measurements, unless there is equipment failure or a subject decided to withdraw midway through collection. <em>Longitudinal</em> data is spaced much further in time, typically days, weeks, months or years. This has <em>two</em> consequences. Firstly, there is a naturalistic ordering to the measurements that needs to be taken into account. If we are looking for patterns in the data, we want these to be defined in terms of <em>time</em>. Secondly, the gap of time between the measurements needs to be considered. If we taken measurements at 1 year, 2 years and 5 years, we cannot treat the effect of a 2 year gap the same as a 5 year gap. The amount of time passed needs to be in the model. This is not true of repeated measurements, where we can model the effects of the different levels without consideration of <em>order</em> or <em>measurement gap</em>. Missing data is also much more common in longitudinal data, as you might imagine. This is where LME models have an advantage over other methods, thanks to <em>pooling</em> and <em>shrinkage</em>.</p>
<p>As an example of longitudinal data, we will examine a dataset of autistic children measured on a scale of <em>socialisation</em> at ages 2, 3, 5, 9 and 13 years. Notice that there are uneven gaps between these measurements, which needs to be accommodated. In addition, there will almost certainly be missing data considering the practical difficulties of getting autistic children to reliably return for measurement across 11 years of their lives. Of importance is that we need to consider the <em>reasons</em> for missing data. If these are innocuous, such as the family moving house, then this is unfortunate be not disastrous. However, if the missingness speaks to some sort of <em>confound</em> then we are in trouble. For instance, if the reason why children do not return is <em>related</em> to poor socialisation skills, then this will create a bias, as the <em>worst</em> cases will disappear over time and it will appear as if socialisation is improving when the <em>opposite</em> might be true. This highlights the serious difficulties around longitudinal data and the inferences that we can draw.</p>
</section>
<section id="clustered-longitudinal">
<h3>Clustered Longitudinal<a class="headerlink" href="#clustered-longitudinal" title="Link to this heading">#</a></h3>
<p>Finally, clustered longitudinal data combines elements of both <em>longitudinal</em> and <em>clustered</em> data. In these types of datasets, measurements are taken repeatedly from the unit of analysis, but these units are also grouped within clusters. We therefore have a correlation structure that relates to both the repeated measurements over time and to the clusters.</p>
<p>As an example, we will look at a dataset where measurements of gingivitis were taken from teeth that had been fitted with dental veneers. These measurements were taken 3 months after fitting and 6 months after fitting. This time gap is long and has a clear temporal ordering, so we would think of this of <em>longitudinal</em> rather than <em>repeated measurements</em>. In addition, <em>multiple</em> teeth were sampled from each patient. So, each tooth has two measurements over time and is clustered within a specific individual. This adds an addition layer of variation, because teeth from the same subject are likely to be correlated. Hence, this is clustered longitudinal data.</p>
<div class="tip admonition">
<p class="admonition-title">A Note on Time Series Data</p>
<p>As a point of clarity, another type of data you may come across is <em>time series</em> data. Unlike longitudinal data, time series data are generated from a <em>single</em> unit and tend to have many more measurements taken much closer in time. One example could be real-time measurements of gait from someone with Parkinson’s disease who is asked to perform a walking task. By the end of the task, there may be hundreds or thousands of measurements taken from across time on this single unit. Importantly, these type of data will exhibit a <em>very specific</em> correlation pattern, where values close together in time will be <em>more correlated</em> than values further away in time. This requires a specialised correlation structure, known as an <em>autoregressive</em> model, which parameterises the correlation as decreasing with time. These types of structure are more difficult to specify using mixed-effects models and provide a good opportunity to use GLS.</p>
</div>
</section>
</section>
<section id="structures-as-hierarchies">
<h2>Structures as Hierarchies<a class="headerlink" href="#structures-as-hierarchies" title="Link to this heading">#</a></h2>
<p>… It is important to define your <em>unit of analysis</em> …</p>
<p>A summary of the types of data, their associated examples and the various levels of the hierarchy are given in the table below. For each example, the <em>unit</em> of analysis is given in <em>italics</em>.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Data Type</strong></p></th>
<th class="head"><p><strong>Clustered (2-level)</strong></p></th>
<th class="head"><p><strong>Clustered (3-level)</strong></p></th>
<th class="head"><p><strong>Repeated Measures</strong></p></th>
<th class="head"><p><strong>Longitudinal</strong></p></th>
<th class="head"><p><strong>Clustered Longitudinal</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Example</strong></p></td>
<td><p>Rat Pup</p></td>
<td><p>Classroom</p></td>
<td><p>Rat Brain</p></td>
<td><p>Autism</p></td>
<td><p>Dental Veneer</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Level 1</strong></p></td>
<td><p><em>Rat Pup</em></p></td>
<td><p><em>Student</em></p></td>
<td><p>Replications within each treatment</p></td>
<td><p>Measures across years</p></td>
<td><p>Measures across months</p></td>
</tr>
<tr class="row-even"><td><p><strong>Level 2</strong></p></td>
<td><p>Litter</p></td>
<td><p>Classroom</p></td>
<td><p><em>Rat</em></p></td>
<td><p><em>Child</em></p></td>
<td><p><em>Tooth</em></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Level 3</strong></p></td>
<td><p></p></td>
<td><p>School</p></td>
<td><p></p></td>
<td><p></p></td>
<td><p>Patient</p></td>
</tr>
</tbody>
</table>
</div>
<p>The easiest way to think about this is as follows:</p>
<ul class="simple">
<li><p><strong>Level 1</strong> represents observations at the <em>most detailed</em> level of the dataset. For <em>clustered</em> data, this represents the <em>units</em> of analysis, whereas for <em>repeated measurement/longitudinal</em> data this represents the repeated measurements collected for each unit. Remember, the outcome variable is always measured at Level 1 and so Level 1 represents the finest granularity of whatever that measurement is.</p></li>
<li><p><strong>Level 2</strong> represents the next level in the hierarchy. For <em>clustered</em> data, this will be the <em>clusters of units</em>. For <em>repeated measurement/longitudinal</em> data, this will represent the <em>units</em> of analysis.</p></li>
<li><p><strong>Level 3</strong> represents the next level in the hierarchy, above Level 2. For <em>clustered</em> data, this will represent <em>clusters of clusters</em>. For <em>clustered longitudinal</em> data, this will represent clusters of the units defined at Level 2.</p></li>
</ul>
<p>There is not usually more than 3 levels in these types of datasets, though this is neither a rule nor a limitation. Part of the challenge of using a multilevel conceptualisations is defining what a particular dataset actually is. We can use the rules above to define each level of the data, but only is we know what type of structure we have. We will now turn to a set of steps you can use to try and determine this. Once it is known, apply the definitions of the levels above, and you should be able to write a table similar to the above for your data. This will be the first step in building the most suitable model.</p>
</section>
<section id="how-to-determine-the-structure-of-a-dataset">
<h2>How to Determine the Structure of a Dataset?<a class="headerlink" href="#how-to-determine-the-structure-of-a-dataset" title="Link to this heading">#</a></h2>
</section>
<section id="step-1-determine-the-unit-of-analysis">
<h2>Step 1. Determine the <em>unit</em> of analysis<a class="headerlink" href="#step-1-determine-the-unit-of-analysis" title="Link to this heading">#</a></h2>
</section>
<section id="step-2-determine-what-each-row-of-the-dataset-represents">
<h2>Step 2. Determine what each <em>row</em> of the dataset represents<a class="headerlink" href="#step-2-determine-what-each-row-of-the-dataset-represents" title="Link to this heading">#</a></h2>
<p>Importantly, this corresponds to rows in the <em>long format</em>, so any wide-formatted data need to be converted first.</p>
<ul class="simple">
<li><p>If each row is <em>one unit</em> measured <em>multiple times</em>, then this is either repeated measures or longitudinal.</p></li>
<li><p>If each row is <em>one unit</em> measured</p></li>
</ul>
</section>
<section id="step-3-determine-whether-you-have-clusters">
<h2>Step 3. Determine whether you have clusters<a class="headerlink" href="#step-3-determine-whether-you-have-clusters" title="Link to this heading">#</a></h2>
<p>… We can use a <em>visual metaphor</em> here to try and make the distinction clear: <em>rubber bands</em> vs <em>sticky notes</em>.</p>
<p>To make the distinctions, consider whether the grouping represents something the unit HAS vs something that the unit is IN. Clustering corresponds to shared context and thus is something a unit is IN: a school, a classroom, a clinic, a hospital, a litter, a neighbourhood. Between-subjects grouping corresponds to a shared characteristic of the unit and thus is something the unit HAS: a diagnosis, a blood type, a gender, an experimental treatment, IQ level.</p>
<p>Another way to think about this is that a between-subjects variable represents a <em>systematic difference</em> that we want to capture. These variables affect the <em>mean structure</em>. Clusters, on the other hand, represent a <em>shared latent influence</em> that affects the <em>covariance structure</em>.</p>
<div class="tip admonition">
<p class="admonition-title">Clusters vs Between-subject Groups</p>
<p>… The difference comes down to <em>error structure</em>. Imagine we are only focussed on a single school and take a single pupil from a specific maths classroom and find that their test score is unusually <em>low</em> compared to the population mean of <em>all</em> maths scores across <em>all</em> the maths classrooms. The question is then, does this tell us anything about another pupil from a <em>different</em> classroom? In general, <em>no</em>. Just because that student’s score is low, it does not mean another pupil from an entirely separate classroom with a different teacher would also be low. <em>However</em>, if we take a <em>different</em> pupil from the <em>same</em> classroom, this student’s score may well tell us <em>something</em> about another pupil. Because they both share the same <em>context</em> (classroom environment, teacher, pupils), there could be a relationship here. If one student is scoring <em>below</em> the average, it could be that <em>all</em> pupils in that classroom are also scoring below the average due to the teacher, or another other shared elements. So, in this example, the <em>clustering</em> creates the potential for correlation.</p>
<p>To see how this differs from a between-subject grouping, imagine we had a sample of patients diagnosed with major depressive disorder (MDD). If we take one patient at random and calculate a mood score, it might be below the average mood of all people with depression. It might also be above the average mood, or pretty much spot-on. Either way, this tells us <em>nothing</em> about the mood of someone else with MDD. We cannot predict the deviation from the average in one person based on another. So the patients are <em>independent</em> and this is a <em>between-subjects</em> grouping, rather than a <em>cluster</em>. There is no shared environment or context that would induce correlation within the errors.</p>
<p>However, there <em>could</em> be additional structure here that would induce correlation. For instance, imagine that the patients with MDD are also clustered within <em>treatment clinics</em>. These clinics correspond to a shared environment, with the same doctors, nurses, location and equipment. In this instance, patients treated at the same clinic <em>could</em> be correlated. Perhaps one clinic is just more effective at treatment than another. In this case, all mood scores from that clinical will be <em>higher</em> than the population average. Knowing one patient’s deviation <em>does</em> allow us to predict another patient’s deviation. Because they were treated at the <em>same</em> clinic, they may <em>both</em> have similarly high deviations from the population mean. Importantly, this does not allow us to predict another patient’s deviation in mood from an entirely separate clinic. So, in this structure, clinics are independent, but patients within clinics may share some degree of dependency.</p>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "r"
        },
        kernelOptions: {
            name: "ir",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'ir'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="0.intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Introduction</p>
      </div>
    </a>
    <a class="right-next"
       href="2.building-mixed.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Building Mixed-effects Models</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#types-of-structure">Types of Structure</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustered-data">Clustered Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#repeated-measurements">Repeated Measurements</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#longitudinal">Longitudinal</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#clustered-longitudinal">Clustered Longitudinal</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structures-as-hierarchies">Structures as Hierarchies</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#how-to-determine-the-structure-of-a-dataset">How to Determine the Structure of a Dataset?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-1-determine-the-unit-of-analysis">Step 1. Determine the <em>unit</em> of analysis</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-2-determine-what-each-row-of-the-dataset-represents">Step 2. Determine what each <em>row</em> of the dataset represents</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#step-3-determine-whether-you-have-clusters">Step 3. Determine whether you have clusters</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Dr Martyn McFarquhar
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2026.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>